<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:jsf="http://xmlns.jcp.org/jsf"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:b="http://bootsfaces.net/ui"
      xmlns:p="http://xmlns.jcp.org/jsf/passthrough">

<h:head>
    <title>TheBlog</title>
    <h:outputStylesheet name="css/style.css"/>
    <f:metadata>
        <f:viewParam name="id" value="#{postController.postId}" converter="javax.faces.Long"/>
        <f:event type="preRenderView" listener="#{postController.onInit}"/>
    </f:metadata>

</h:head>

<h:body>
    <f:view>
        <b:navBar brand="Brand" brandHref="#" styleClass="noMargin">
            <b:navbarLinks>
                <b:navLink value="Home" href="#"/>
                <b:navLink value="Link" href="#"/>
                <b:navLink value="Link" href="#"/>
            </b:navbarLinks>
        </b:navBar>
        <b:jumbotron>
            <b:container>
                <b:row>
                    <b:column col-xs="12" col-sm="10">
                        <h1>TheBlog</h1>
                        <p style="margin-left: 11px">Post, Comment and Vote!</p>
                        <hr style="border-color: rgba(51, 51, 51, 0.6)"/>
                        <h4 style="margin-left: 12px">A demo blog</h4>
                    </b:column>
                </b:row>
            </b:container>
        </b:jumbotron>
        <b:container id="container">
            <h3 style="text-align: center; margin-top: 8px;">Post</h3>
            <b:row>
                <ui:fragment id="fragment" rendered="#{postController.post != null}">
                    <b:well styleClass="xs-padding">
                        <div jsf:id="divTitle"
                             style="font-weight: bolder; font-size: larger">
                            <h:outputText value="#{postController.post.title}"/>
                        </div>
                        <div jsf:id="divSubtitle">
                            <h:outputText value="#{postController.post.category.name}"/>
                        </div>
                        <hr class="small-height"/>
                        <b:row>
                            <b:column col-xs="1"
                                      style="align-self: center; text-align: center">
                                <h:form>
                                    <ui:fragment rendered="true">
                                        <b:commandButton styleClass="buttonLink" tooltip="Upvote"
                                                         update="tLikes" ajax="true"
                                                         actionListener="#{indexController.upvotePost(postController.post)}">
                                            <b:iconAwesome value="caret-up" size="2x"
                                                           styleClass="text-muted small-line-height"/>
                                        </b:commandButton>
                                    </ui:fragment>
                                    <ui:fragment rendered="false">

                                    </ui:fragment>
                                    <div jsf:id="divLikes">
                                        <h:outputText id="tLikes" value="#{postController.post.likes}"/>
                                    </div>
                                    <ui:fragment rendered="true">
                                        <b:commandButton styleClass="buttonLink buttonMargin" tooltip="Downvote"
                                                         update="tLikes" tooltipPosition="right" ajax="true"
                                                         actionListener="#{indexController.downvotePost(postController.post)}">
                                            <b:iconAwesome value="caret-down" size="2x"
                                                           styleClass="text-muted small-line-height"/>
                                        </b:commandButton>
                                    </ui:fragment>
                                    <ui:fragment rendered="false">

                                    </ui:fragment>
                                </h:form>
                            </b:column>
                            <b:column col-xs="11">
                                <div class="small-height">
                                    #{postController.post.content}
                                </div>
                            </b:column>
                        </b:row>
                        <b:row>
                            <b:column colSm="3">
                                <h:form>
                                    <b:commandButton tooltip="New Comment" tooltipPosition="left"
                                                     ajax="true" oncomplete="showModal1()" update=":form1"
                                                     look="primary" iconAwesome="fa-commenting" class="icon"
                                                     actionListener="#{postController.createNewComment}">
                                    </b:commandButton>
                                </h:form>
                            </b:column>
                            <b:column colSm="9" style="display: flex">
                                <div class="align-center">
                                    <ui:fragment rendered="#{!empty postController.post.lastUpdatedAt}">
                                        <div>
                                            <div class="small">
                                                <h:outputText
                                                        value="Created #{postController.post.createdAt.toString().substring(0, 10)}"/>
                                            </div>
                                            <div class="small">
                                                <h:outputText
                                                        value="Edited #{postController.post.lastUpdatedAt.toString().substring(0, 10)}"/>
                                            </div>
                                        </div>
                                    </ui:fragment>
                                    <ui:fragment rendered="#{empty postController.post.lastUpdatedAt}">
                                        <div class="small">
                                            <h:outputText
                                                    value="Created #{postController.post.createdAt.toString().substring(0, 10)}"/>
                                        </div>
                                    </ui:fragment>
                                </div>
                                <div class="align-center">
                                    <b:iconAwesome value="user-circle" style="margin-right: 5px"
                                                   styleClass="pull-right" size="2x"/>
                                </div>
                                <div class="align-center">
                                    <h:outputText value="#{postController.post.authorname}"/>
                                </div>
                            </b:column>
                        </b:row>
                    </b:well>
                </ui:fragment>
            </b:row>
        </b:container>
        <b:modal id="modal1" title="Create Comment" size="lg">
            <h:form id="form1">
                <b:inputTextarea label="Inhalt:" labelStyle="width:80px;"
                                 value="#{postController.currentComment.content}"/>
            </h:form>
        </b:modal>
    </f:view>
</h:body>
</html>